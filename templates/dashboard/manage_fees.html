{% extends 'base.html' %}
{% block title %}Fee Management{% endblock %}
{% block content %}
{% include 'partials/admin_nav.html' with active_page='fees' %}
<section class="two-col">
  <div class="panel">
    <h2>Create / Update Fee Record</h2>
    <form method="post" class="stack-form">
      {% csrf_token %}
      <div class="form-grid">
        <div><label>Student</label>{{ form.student }}</div>
        <div><label>Term</label>{{ form.term }}</div>
        <div><label>Total Amount</label>{{ form.total_amount }}</div>
        <div><label>Paid Amount</label>{{ form.paid_amount }}</div>
        <div><label>Due Date</label>{{ form.due_date }}</div>
      </div>
      {% if form.errors %}
      <div class="form-errors">{{ form.errors }}</div>
      {% endif %}
      <button class="btn btn-primary" type="submit">Save Fee Record</button>
    </form>
  </div>

  <div class="panel">
    <h2>Fee Records</h2>
    <table>
      <thead>
        <tr><th>Student</th><th>Term</th><th>Total</th><th>Paid</th><th>Due Date</th></tr>
      </thead>
      <tbody>
        {% for fee in fee_records %}
        <tr>
          <td>{{ fee.student.admission_no }} - {{ fee.student.user.get_full_name|default:fee.student.user.username }}</td>
          <td>{{ fee.term }}</td>
          <td>{{ fee.total_amount }}</td>
          <td>{{ fee.paid_amount }}</td>
          <td>{{ fee.due_date }}</td>
        </tr>
        {% empty %}
        <tr><td colspan="5">No fee records yet.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>
{% endblock %}
